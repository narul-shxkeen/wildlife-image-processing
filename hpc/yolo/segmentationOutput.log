Running on host: compute4
CUDA_VISIBLE_DEVICES: 
Python version: Python 3.10.18
LD_LIBRARY_PATH: /home/vaibhav.shokeen_ug25/wildlife/yolo/../../venvs/sam_yolo/lib:/apps/compilers/anaconda3/lib64:/usr/local/cuda/lib:
Sat Nov 29 23:06:53 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           Off |   00000000:5E:00.0 Off |                    0 |
| N/A   60C    P0            179W /  250W |     909MiB /  32768MiB |     98%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    109120      C   /apps/gromac_gpc-2023/bin/gmx_mpi             520MiB |
|    0   N/A  N/A    113360      C   gmx_mpi                                       386MiB |
+-----------------------------------------------------------------------------------------+
======================================================================
GPU/CUDA Status
======================================================================
PyTorch version: 2.6.0+cu118
CUDA available: True
CUDA version: 11.8
GPU device: Tesla V100-PCIE-32GB
GPU memory: 34.07 GB
Current device: 0
✅ CUDA is available - will use GPU acceleration
======================================================================

Configuration:
  Dataset directory: dataset
  Labels JSON: image_categories_cleaned.json
  Output directory: output_sam_yolo
  SAM checkpoint: sam_vit_b_01ec64.pth
  Number of samples: 6000
  Device: cuda
  Max image size: 640
  SAM performance: points_per_side=12, pred_iou=0.88, stability=0.95
  Filtering to 7 species: Common leopard, Himalayan goral, Himalayan gray langur, Himalayan tahr, Leopard cat, Rhesus macaque, Yellow-throated marten

Loading labels...
Gathering images from dataset...
Found 6474 labeled images
Found 6471 images with allowed species
Species distribution:
  Himalayan goral: 1981 images
  Himalayan tahr: 1592 images
  Himalayan gray langur: 1490 images
  Common leopard: 784 images
  Rhesus macaque: 326 images
  Leopard cat: 197 images
  Yellow-throated marten: 101 images

✅ Sampled 6000 images for processing
✅ Created classes.txt with 7 classes

Loading SAM model...
✅ SAM loaded on GPU: Tesla V100-PCIE-32GB
   GPU Memory: 34.07 GB

======================================================================
Starting image processing
======================================================================


======================================================================
Processing complete!
======================================================================
✅ Successfully processed: 4394 images
⚠️  Skipped (OOM): 0 images
⚠️  Skipped (no valid mask): 1606 images
⚠️  Skipped (read error): 0 images

Output directory: output_sam_yolo
  - images/: 4394 files
  - labels/: 4394 files
  - vis/: 4394 files
  - classes.txt: 7 classes

Peak GPU memory: 2.90 GB
======================================================================

segmentation script ran
